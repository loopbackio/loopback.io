"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([[5237],{3905:function(e,n,t){t.d(n,{Zo:function(){return c},kt:function(){return h}});var a=t(7294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var l=a.createContext({}),p=function(e){var n=a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},c=function(e){var n=p(e.components);return a.createElement(l.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},d=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=p(t),h=r,m=d["".concat(l,".").concat(h)]||d[h]||u[h]||o;return t?a.createElement(m,i(i({ref:n},c),{},{components:t})):a.createElement(m,i({ref:n},c))}));function h(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var o=t.length,i=new Array(o);i[0]=d;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var p=2;p<o;p++)i[p]=t[p];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},2931:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return p},assets:function(){return c},toc:function(){return u},default:function(){return h}});var a=t(7462),r=t(3366),o=(t(7294),t(3905)),i=["components"],s={title:"Building an Online Game With LoopBack 4 - Front-end with React (Part 6)",date:new Date("2019-08-28T00:00:00.000Z"),authors:"wenbo",slug:"building-an-online-game-with-loopback-4-pt6",tags:["learning","how-to"]},l=void 0,p={permalink:"/blog/building-an-online-game-with-loopback-4-pt6",editUrl:"https://github.com/loopbackio/loopback-blog/blog/2019/2019-08-28-building-an-online-game-with-loopback-4-pt6.md",source:"@site/blog/2019/2019-08-28-building-an-online-game-with-loopback-4-pt6.md",title:"Building an Online Game With LoopBack 4 - Front-end with React (Part 6)",description:"Part 6: Front-end with React",date:"2019-08-28T00:00:00.000Z",formattedDate:"August 28, 2019",tags:[{label:"learning",permalink:"/blog/tags/learning"},{label:"how-to",permalink:"/blog/tags/how-to"}],readingTime:15.215,truncated:!0,authors:[{name:"Wen Bo",title:"LoopBack Maintainer",url:"https://github.com/gobackhuoxing",imageURL:"https://avatars.githubusercontent.com/u/22156589",key:"wenbo"}],frontMatter:{title:"Building an Online Game With LoopBack 4 - Front-end with React (Part 6)",date:"2019-08-28T00:00:00.000Z",authors:"wenbo",slug:"building-an-online-game-with-loopback-4-pt6",tags:["learning","how-to"]},prevItem:{title:"LoopBack 4 August 2019 Milestone Update",permalink:"/blog/august-2019-milestone"},nextItem:{title:"Learning LoopBack 4 Interceptors (Part 2) - Method Level and Class Level Interceptors",permalink:"/blog/loopback4-interceptors-part2"}},c={authorsImageUrls:[void 0]},u=[{value:"Part 6: Front-end with React",id:"part-6-front-end-with-react",children:[{value:"In This Episode",id:"in-this-episode",children:[],level:3},{value:"Introduction",id:"introduction",children:[],level:3},{value:"Previously on Building an Online Game With LoopBack 4",id:"previously-on-building-an-online-game-with-loopback-4",children:[],level:3},{value:"Prerequisites",id:"prerequisites",children:[],level:3},{value:"Initializing React Project",id:"initializing-react-project",children:[],level:3},{value:"structure Designing",id:"structure-designing",children:[],level:3},{value:"<code>App.jsx</code>",id:"appjsx",children:[],level:3},{value:"Containers",id:"containers",children:[{value:"Login and Signup",id:"login-and-signup",children:[],level:4}],level:3},{value:"HomePage",id:"homepage",children:[],level:3},{value:"Components",id:"components",children:[{value:"InitCharacter",id:"initcharacter",children:[],level:4},{value:"Display",id:"display",children:[],level:4}],level:3},{value:"Services",id:"services",children:[{value:"<code>authenticationService</code>",id:"authenticationservice",children:[],level:4},{value:"<code>userService</code>",id:"userservice",children:[],level:4}],level:3},{value:"Applying This to Your Own Project",id:"applying-this-to-your-own-project",children:[],level:3},{value:"What&#39;s Next?",id:"whats-next",children:[],level:3}],level:2}],d={toc:u};function h(e){var n=e.components,s=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},d,s,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"part-6-front-end-with-react"},"Part 6: Front-end with React"),(0,o.kt)("h3",{id:"in-this-episode"},"In This Episode"),(0,o.kt)("p",null,"Now our project is on IBM Cloud. But you may notice there is not anything that we can actually play with. It's just some APIs. How can we call it a game without front-end UI?"),(0,o.kt)("p",null,"In this episode, I will build signup, login, and home pages with ",(0,o.kt)("a",{parentName:"p",href:"https://reactjs.org/"},"React"),"."),(0,o.kt)("p",null,"You can check ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/gobackhuoxing/first-web-game-lb4/tree/part6/firstgame"},"here")," for the code from this episode."),(0,o.kt)("h3",{id:"introduction"},"Introduction"),(0,o.kt)("p",null,"In this series, I\u2019m going to help you learn LoopBack 4 and how to use it to easily build your own API and web project. We\u2019ll create a new project I\u2019ve been thinking about: an online web text-based adventure game. In this game, you can create your own account to build characters, fight monsters and find treasures. You will be able to control your character to take a variety of actions: attacking enemies, casting spells, and getting loot. This game also allows multiple players to log in and play with their friends."),(0,o.kt)("h3",{id:"previously-on-building-an-online-game-with-loopback-4"},"Previously on Building an Online Game With LoopBack 4"),(0,o.kt)("p",null,"In the last episode, we covered how to run our project in Docker and push it to Kubernetes cluster on IBM Cloud."),(0,o.kt)("p",null,"Here are the previous episodes:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://strongloop.com/strongblog/building-online-game-with-loopback-4-pt1/"},"Part 1: Building a Simple LoopBack Project With MongoDB")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://strongloop.com/strongblog/building-an-online-game-with-loopback-4-pt2/"},"Part 2: Generating Universally Unique ID and Managing Models Relationships")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://strongloop.com/strongblog/building-an-online-game-with-loopback-4-pt3/"},"Part 3: Customizing APIs in Controller")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://strongloop.com/strongblog/building-an-online-game-with-loopback-4-pt4/"},"Part 4: User Authentication and Role-Based Access Control")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://strongloop.com/strongblog/building-an-online-game-with-loopback-4-pt5/"},"Part 5: Deploying our Application to Kubernetes on IBM Cloud"))),(0,o.kt)("h3",{id:"prerequisites"},"Prerequisites"),(0,o.kt)("p",null,"I am completely new to the front-end world. So I took some online courses.\nIf you don't have any front-end experience like me, you should spend some time on the basic knowledge before moving on."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://javascript30.com/"},"Javascript 30 days")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://www.youtube.com/watch?v=Ke90Tje7VS0"},"Learn React - React Crash Course"))),(0,o.kt)("p",null,"You don't need to finish them all. Watching online courses is boring. You can start to write code whenever you think you are ready."),(0,o.kt)("p",null,"I will also use some other libraries."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://www.npmjs.com/package/axios"},"axios")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://www.npmjs.com/package/bootstrap"},"bootstrap")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://www.npmjs.com/package/react-bootstrap"},"react-bootstrap")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://www.npmjs.com/package/react-router-dom"},"react-router-dom"))),(0,o.kt)("p",null,"You don't have to fully understand them before. I will show you how to use them step by step."),(0,o.kt)("h3",{id:"initializing-react-project"},"Initializing React Project"),(0,o.kt)("p",null,"Install ",(0,o.kt)("inlineCode",{parentName:"p"},"create-react-app")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"npm i create-react-app\n")),(0,o.kt)("p",null,"Then run this to create a new react project:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"create-react-app <your_project_name>\n")),(0,o.kt)("p",null,"If you go to the project you just created and run ",(0,o.kt)("inlineCode",{parentName:"p"},"npm start"),", you will see a page like this:"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"default_page",src:t(6472).Z,width:"2090",height:"1110"})),(0,o.kt)("h3",{id:"structure-designing"},"structure Designing"),(0,o.kt)("p",null,"Before we start, we need to spend some time on the project structure."),(0,o.kt)("p",null,"In a React project, everything is ",(0,o.kt)("a",{parentName:"p",href:"https://reactjs.org/docs/react-component.html"},"component"),". Your pages, navigation bar, input form, or even a button, all of them could be components. All of those components are organized in a tree structure. Here is my project structure."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"structure",src:t(2128).Z,width:"2224",height:"1406"})),(0,o.kt)("p",null,"And here is my directory structure:"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"directory",src:t(276).Z,width:"678",height:"446"})),(0,o.kt)("h3",{id:"appjsx"},(0,o.kt)("inlineCode",{parentName:"h3"},"App.jsx")),(0,o.kt)("p",null,"First, open the ",(0,o.kt)("inlineCode",{parentName:"p"},"src/App.js")," file. It will be the parent of all other components."),(0,o.kt)("p",null,"Change your ",(0,o.kt)("inlineCode",{parentName:"p"},"App.js")," to ",(0,o.kt)("inlineCode",{parentName:"p"},"App.jsx"),". It makes our life easier to use ",(0,o.kt)("inlineCode",{parentName:"p"},".jsx")," in React."),(0,o.kt)("p",null,"Then change your ",(0,o.kt)("inlineCode",{parentName:"p"},"App.jsx")," to this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},'import React, { Component } from "react";\nimport { BrowserRouter as Router, Redirect, Route } from "react-router-dom";\nimport { NavBar } from "./components";\nimport { Login, Signup, HomePage } from "./containers";\nimport { userService, authenticationService } from "./services";\nimport "./containers/style.css";\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      currentUser: "",\n      data: {},\n      gear: {}\n    };\n    this.handelLogout = this.handelLogout.bind(this);\n    this.handelUserData = this.handelUserData.bind(this);\n  }\n  componentDidMount() {\n    this.handelUserData();\n  }\n\n  handelLogout() {\n    authenticationService.logout();\n    this.setState({ currentUser: "", data: {}, gear: {} });\n  }\n\n  handelUserData() {\n    const currentUser = localStorage.getItem("currentUser");\n    if (currentUser) {\n      this.setState({ currentUser });\n      userService.getUserData(currentUser, this);\n      userService.getGearData(currentUser, this);\n    }\n  }\n\n  render() {\n    const { gear, data, currentUser } = this.state;\n    return (\n      <div className="jumbotron">\n        <NavBar data={data} onLogout={this.handelLogout} />\n        <div className="container basic">\n          <div className="col-sm-8 col-sm-offset-2 basic">\n            <Router>\n              <div>\n                <Route\n                  exact\n                  path="/"\n                  render={props =>\n                    localStorage.getItem("currentUser") ? (\n                      <HomePage\n                        {...props}\n                        currentUser={currentUser}\n                        data={data}\n                        gear={gear}\n                        handelUserData={this.handelUserData}\n                      />\n                    ) : (\n                      <Redirect\n                      to={\n                        {\n                          pathname: "/login",\n                          state: { from: props.location }\n                        }\n                      }\n                      />\n                    )\n                  }\n                />\n                <Route\n                  path="/login"\n                  render={props => (\n                    <Login {...props} handelUserData={this.handelUserData} />\n                  )}\n                />\n                <Route path="/signup" component={Signup} />\n              </div>\n            </Router>\n          </div>\n        </div>\n        <div className="text-center">\n          <p>\n            <a href="https://loopback.io/">Powered by Loopback 4</a>\n          </p>\n          <p>\n            <a href="https://github.com/gobackhuoxing/first-web-game-lb4">\n              Github@gobackhuoxing\n            </a>\n          </p>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport { App };\n')),(0,o.kt)("p",null,"Here we will use a library called ",(0,o.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/react-router-dom"},"react-router-dom"),". Simply run ",(0,o.kt)("inlineCode",{parentName:"p"},"npm install react-router-dom")," to install it. This library allows us to navigate between different components."),(0,o.kt)("p",null,"Let's go through this line by line."),(0,o.kt)("p",null,"The first thing you can see is:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},'this.state = {\n  currentUser: "",\n  data: {},\n  gear: {}\n};\n')),(0,o.kt)("p",null,"This is the state of this component. Because we are using ",(0,o.kt)("inlineCode",{parentName:"p"},"JWT")," in back-end for login. we need to store the token for future API calls. We also need to store the basic user information, so we can display it somewhere."),(0,o.kt)("p",null,"Then we have three functions:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},'  componentDidMount() {\n    this.handelUserData();\n  }\n\n  handelLogout() {\n    authenticationService.logout();\n    this.setState({ currentUser: "", data: {}, gear: {} });\n  }\n\n  handelUserData() {\n    const currentUser = localStorage.getItem("currentUser");\n    if (currentUser) {\n      this.setState({ currentUser });\n      userService.getUserData(currentUser, this);\n      userService.getGearData(currentUser, this);\n    }\n  }\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"handelLogout")," is a function to logout. It will remove our token from ",(0,o.kt)("inlineCode",{parentName:"li"},"localStorage")," and user data from ",(0,o.kt)("inlineCode",{parentName:"li"},"state"),"."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"handelUserData")," is a function to fetch user data from back-end and store the data in ",(0,o.kt)("inlineCode",{parentName:"li"},"state"),". In react, never change ",(0,o.kt)("inlineCode",{parentName:"li"},"state")," directly. If you do that, React will not update the page, because it doesn't know what has been changed. You should always use ",(0,o.kt)("inlineCode",{parentName:"li"},"setState()")," to change ",(0,o.kt)("inlineCode",{parentName:"li"},"state")," so that React can update all pages that related to this change."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"authenticationService")," and ",(0,o.kt)("inlineCode",{parentName:"li"},"userService")," are my self-defined services to do all of the API calls."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"componentDidMount")," is a react build-in function that will be executed after the first render. I use it to get user data before page loading. You can check ",(0,o.kt)("a",{parentName:"li",href:"https://www.tutorialspoint.com/reactjs/reactjs_component_life_cycle"},"here")," for more information about the React component life cycle.")),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"render")," function defined how does our component look like. I have four children components here: ",(0,o.kt)("inlineCode",{parentName:"p"},"NavBar"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"HomePage"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"Login"),", and ",(0,o.kt)("inlineCode",{parentName:"p"},"Signup"),"."),(0,o.kt)("p",null,"We use ",(0,o.kt)("inlineCode",{parentName:"p"},"react-router-dom")," for redirecting. I have three pages in my route:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},'Login("/login")'),(0,o.kt)("li",{parentName:"ul"},'Signup("/signup")'),(0,o.kt)("li",{parentName:"ul"},'HomePage("/")')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},'<Route\n  exact\n  path="/"\n  render={props =>\n    localStorage.getItem("currentUser") ? (\n      <HomePage\n        {...props}\n        currentUser={currentUser}\n        data={data}\n        gear={gear}\n        handelUserData={this.handelUserData}\n      />\n    ) : (\n      <Redirect\n      to={\n        {\n          pathname: "/login",\n          state: { from: props.location }\n        }\n      }\n      />\n    )\n  }\n/>\n')),(0,o.kt)("p",null,"If we can find token in ",(0,o.kt)("inlineCode",{parentName:"p"},"localStorage"),", we will go to ",(0,o.kt)("inlineCode",{parentName:"p"},"HomePage"),", otherwise, we will go to ",(0,o.kt)("inlineCode",{parentName:"p"},"Login"),"."),(0,o.kt)("p",null,"You can check ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/gobackhuoxing/first-web-game-lb4/blob/part6/firstgame-frontend/src/App.jsx"},"here")," for my code of ",(0,o.kt)("inlineCode",{parentName:"p"},"App.jsx"),"."),(0,o.kt)("h3",{id:"containers"},"Containers"),(0,o.kt)("p",null,"A container is also a component. It is also a holder for other components. We have three containers: ",(0,o.kt)("inlineCode",{parentName:"p"},"HomePage"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"Login"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"Signup"),"."),(0,o.kt)("p",null,"Let's first create a ",(0,o.kt)("inlineCode",{parentName:"p"},"containers")," folder in ",(0,o.kt)("inlineCode",{parentName:"p"},"/src"),"."),(0,o.kt)("h4",{id:"login-and-signup"},"Login and Signup"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"login",src:t(5352).Z,width:"2364",height:"948"})),(0,o.kt)("p",null,"This is my ",(0,o.kt)("inlineCode",{parentName:"p"},"Login.jsx"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},'import React, { Component } from "react";\nimport { authenticationService } from "../services";\n\nclass Login extends Component {\n  unmount = false;\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      email: "",\n      password: "",\n      error: "",\n      submitted: false,\n      loading: false,\n      shortPassword: false\n    };\n\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n  }\n\n  componentWillUnmount() {\n    this.unmount = true;\n  }\n\n  handleChange(e) {\n    const { name, value } = e.target;\n    this.setState({ [name]: value });\n  }\n\n  handleSubmit = e => {\n    e.preventDefault();\n    const { email, password } = this.state;\n    const { handelUserData } = this.props;\n\n    this.setState({ submitted: true });\n    if (!(email && password)) {\n      return;\n    }\n    if (password.length < 8) {\n      this.setState({ shortPassword: true });\n      return;\n    }\n\n    this.setState({ loading: true, shortPassword: false });\n    authenticationService.login(email, password, this).then(\n      function() {\n        if (!this.unmount) this.setState({ loading: false });\n      }.bind(this)\n    );\n    handelUserData();\n  };\n\n  render() {\n    const {\n      email,\n      password,\n      error,\n      loading,\n      submitted,\n      shortPassword\n    } = this.state;\n    return (\n      <React.Fragment>\n        <h2>Login</h2>\n        {error && error.response.data.error.statusCode === 404 && (\n          <div className={"alert alert-danger"}>Email doesn\'t exist</div>\n        )}\n        {error && error.response.data.error.statusCode === 401 && (\n          <div className={"alert alert-danger"}>Password is incorrect</div>\n        )}\n        {error && error.response.data.error.statusCode === 422 && (\n          <div className={"alert alert-danger"}>\n            Email or Password is invalid\n          </div>\n        )}\n        <form name="form" onSubmit={this.handleSubmit}>\n          <div className="form-group">\n            <label htmlFor="email">Email</label>\n            <input\n              type="email"\n              className="form-control"\n              name="email"\n              value={email}\n              onChange={this.handleChange}\n            />\n          </div>\n          {submitted && !email && (\n            <div className="alert alert-danger">Email is required</div>\n          )}\n          <div className="form-group">\n            <label htmlFor="password">Password</label>\n            <input\n              type="password"\n              className="form-control"\n              name="password"\n              value={password}\n              onChange={this.handleChange}\n            />\n          </div>\n          {submitted && !password && (\n            <div className="alert alert-danger">Password is required</div>\n          )}\n          {submitted && shortPassword && (\n            <div className="alert alert-danger">\n              Password too short - minimum length is 8 characters\n            </div>\n          )}\n          <div className="form-group">\n            <button className="btn btn-primary" disabled={loading}>\n              Login\n            </button>\n          </div>\n          <div>\n            Don\'t have an account? <a href="/signup"> SignUp!</a>\n          </div>\n        </form>\n      </React.Fragment>\n    );\n  }\n}\nexport { Login };\n')),(0,o.kt)("p",null,"I have an input form to collect data from users and pass that data to back-end. After the user hit the ",(0,o.kt)("inlineCode",{parentName:"p"},"Login")," button, this ",(0,o.kt)("inlineCode",{parentName:"p"},"handleSubmit")," function will be called."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},"handleSubmit = e => {\n  e.preventDefault();\n  const { email, password } = this.state;\n  const { handelUserData } = this.props;\n\n  this.setState({ submitted: true });\n  if (!(email && password)) {\n    return;\n  }\n  if (password.length < 8) {\n    this.setState({ shortPassword: true });\n    return;\n  }\n\n  this.setState({ loading: true, shortPassword: false });\n  authenticationService.login(email, password, this).then(\n    function() {\n      if (!this.unmount) this.setState({ loading: false });\n    }.bind(this)\n  );\n  handelUserData();\n};\n")),(0,o.kt)("p",null,"It basically validates all the user input and action. If everything looks good, it will pass the user's email and password to back-end, otherwise, it will tell the user there is something wrong."),(0,o.kt)("p",null,"It also uses ",(0,o.kt)("inlineCode",{parentName:"p"},"authenticationService")," for login API call. We will talk about that later. The ",(0,o.kt)("inlineCode",{parentName:"p"},"Signup")," page is almost the same. You can check my repo for more details."),(0,o.kt)("h3",{id:"homepage"},"HomePage"),(0,o.kt)("p",null,"After login, the user will be navigated to ",(0,o.kt)("inlineCode",{parentName:"p"},"HomePage"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},'import React, { Component } from "react";\nimport { Display, InitCharacter } from "../components";\nimport "./style.css";\n\nclass HomePage extends Component {\n  componentDidMount() {\n    const { handelUserData, data } = this.props;\n    if (!data) this.props.history.push("/login");\n    handelUserData();\n  }\n\n  render() {\n    const { data, gear, currentUser, handelUserData } = this.props;\n\n    return (\n      <React.Fragment>\n        <div className="basic">\n          {data.name !== "nousername" && (\n            <h2>\n              LV.{data.level} {data.name}\n            </h2>\n          )}\n          {data.name !== "nousername" && (\n            <Display className="basic" data={data} gear={gear} />\n          )}\n\n          {data.name === "nousername" && (\n            <InitCharacter\n              className="basic"\n              currentUser={currentUser}\n              data={data}\n              handelUserData={handelUserData}\n            />\n          )}\n        </div>\n      </React.Fragment>\n    );\n  }\n}\n\nexport { HomePage };\n')),(0,o.kt)("p",null,"We have two children components in ",(0,o.kt)("inlineCode",{parentName:"p"},"HomePage"),":"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"InitCharacter")," to create a new character if this is the user's first time login."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"Display")," to display the user's character information, if the user already has one.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},'{\n  data.name !== "nousername" && (\n    <Display className="basic" data={data} gear={gear} />\n  );\n}\n\n{\n  data.name === "nousername" && (\n    <InitCharacter\n      className="basic"\n      currentUser={currentUser}\n      data={data}\n      handelUserData={handelUserData}\n    />\n  );\n}\n')),(0,o.kt)("p",null,"We will store the user's information in the ",(0,o.kt)("inlineCode",{parentName:"p"},"state")," of ",(0,o.kt)("inlineCode",{parentName:"p"},"App"),". If the user doesn't have a character name, we will show ",(0,o.kt)("inlineCode",{parentName:"p"},"Display")," component, otherwise, we will show ",(0,o.kt)("inlineCode",{parentName:"p"},"InitCharacter")," component."),(0,o.kt)("p",null,"You can check ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/gobackhuoxing/first-web-game-lb4/tree/part6/firstgame-frontend/src/containers"},"here")," for the code of ",(0,o.kt)("inlineCode",{parentName:"p"},"containers"),"."),(0,o.kt)("h3",{id:"components"},"Components"),(0,o.kt)("p",null,"Create a ",(0,o.kt)("inlineCode",{parentName:"p"},"component")," folder in ",(0,o.kt)("inlineCode",{parentName:"p"},"src"),". We will put all re-useable components here."),(0,o.kt)("h4",{id:"initcharacter"},"InitCharacter"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"init",src:t(8458).Z,width:"2364",height:"1506"})),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},'import React, { Component } from "react";\nimport { userService, gearList } from "../services";\nimport "./style.css";\n\nclass InitCharacter extends Component {\n  unmount = false;\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      name: "",\n      error: null,\n      submitted: false,\n      loading: false,\n      lastClick: null\n    };\n\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n  }\n\n  componentWillUnmount() {\n    this.unmount = true;\n  }\n\n  handleChange(e) {\n    const { name, value } = e.target;\n    this.setState({ [name]: value });\n  }\n\n  handleSubmit = e => {\n    e.preventDefault();\n    const { name, lastClick } = this.state;\n    const { currentUser, handelUserData } = this.props;\n\n    this.setState({ submitted: true });\n    if (!name && !lastClick) {\n      return;\n    }\n    this.setState({ loading: true });\n\n    let gear = {};\n    switch (lastClick.id) {\n      case "1":\n        gear = {\n          weapon: gearList.weapons.guideBookJunior,\n          armor: gearList.armors.silkRobe,\n          skill: gearList.skills.sacrifice\n        };\n        break;\n      case "2":\n        gear = {\n          weapon: gearList.weapons.surgicalDagger,\n          armor: gearList.armors.labCoat,\n          skill: gearList.skills.bloodLetting\n        };\n        break;\n      case "3":\n        gear = {\n          weapon: gearList.weapons.rustyShortSword,\n          armor: gearList.armors.chainArmor,\n          skill: gearList.skills.slap\n        };\n        break;\n      default:\n        break;\n    }\n\n    userService.initCharacter(currentUser, name, gear, this).then(function() {\n      handelUserData();\n    });\n  };\n\n  handelClick = e => {\n    const { lastClick } = this.state;\n    e.target.classList.toggle("open");\n    if (lastClick) lastClick.classList.toggle("open");\n    if (!this.unmount) this.setState({ lastClick: e.target });\n  };\n\n  render() {\n    const { name, submitted, loading } = this.state;\n    return (\n      <React.Fragment>\n        <div className="panels">\n          <div id="1" className="panel panel1" onClick={this.handelClick}>\n            <p className="classes">Demon Scholar</p>\n          </div>\n          <div id="2" className="panel panel2" onClick={this.handelClick}>\n            <p className="classes">Plague Doctor</p>\n          </div>\n          <div id="3" className="panel panel3" onClick={this.handelClick}>\n            <p className="classes knight">Knight of Madness</p>\n          </div>\n        </div>\n        <form name="form" onSubmit={this.handleSubmit}>\n          <div className="form-group">\n            <label className="text" htmlFor="name">\n              Character Name\n            </label>\n            <input\n              type="name"\n              className="form-control"\n              name="name"\n              value={name}\n              onChange={this.handleChange}\n            />\n            {submitted && !name && (\n              <div className="alert alert-danger">\n                Character name is required\n              </div>\n            )}\n          </div>\n          <div className="form-group button">\n            <button className="btn btn-primary button" disabled={loading}>\n              Start\n            </button>\n          </div>\n        </form>\n      </React.Fragment>\n    );\n  }\n}\n\nexport { InitCharacter };\n')),(0,o.kt)("p",null,"I have three classes for a user to choose from. If the user clicks one of the classes, the ",(0,o.kt)("inlineCode",{parentName:"p"},"handelClick")," function will store that one in ",(0,o.kt)("inlineCode",{parentName:"p"},"state"),". Then we call ",(0,o.kt)("inlineCode",{parentName:"p"},"userService.initCharacter")," to create a new character."),(0,o.kt)("h4",{id:"display"},"Display"),(0,o.kt)("p",null,"If the user has one character, we will jump to ",(0,o.kt)("inlineCode",{parentName:"p"},"Display")," page to show all of the user information."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"display",src:t(8528).Z,width:"2348",height:"1064"})),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},'import React, { Component } from "react";\nimport { DropdownButton, Dropdown, Table } from "react-bootstrap";\nimport "./style.css";\n\nclass Display extends Component {\n  render() {\n    const { data, gear } = this.props;\n    return (\n      <React.Fragment>\n        <Table striped bordered hover variant="dark">\n          <tbody>\n            <tr>\n              <th>EXP</th>\n              <th>\n                {data.currentExp}/{data.nextLevelExp}\n              </th>\n            </tr>\n            <tr>\n              <th>HP</th>\n              <th>\n                {data.currentHealth}/{data.maxHealth}\n              </th>\n            </tr>\n            <tr>\n              <th>MP</th>\n              <th>\n                {data.currentMana}/{data.maxMana}\n              </th>\n            </tr>\n            <tr>\n              <th>Attack</th>\n              <th>{data.attack}</th>\n            </tr>\n            <tr>\n              <th>defence</th>\n              <th>{data.defence}</th>\n            </tr>\n\n            <tr>\n              <th>\n                <DropdownButton\n                  title="weapon"\n                  variant="danger"\n                  id="weapon"\n                  key="weapon"\n                >\n                  {gear[0] === "no weapon" && (\n                    <Dropdown.Item eventKey="1"> {gear[0]}</Dropdown.Item>\n                  )}\n                  {gear[0] && gear[0] !== "no weapon" && (\n                    <Dropdown.Item eventKey="1">{gear[0].name} </Dropdown.Item>\n                  )}\n                  {gear[0] && gear[0] !== "no weapon" && (\n                    <Dropdown.Item eventKey="1">\n                      Attack: {gear[0].attack}{" "}\n                    </Dropdown.Item>\n                  )}\n                  {gear[0] && gear[0] !== "no weapon" && (\n                    <Dropdown.Item eventKey="1">\n                      Defence: {gear[0].defence}{" "}\n                    </Dropdown.Item>\n                  )}\n                </DropdownButton>\n              </th>\n\n              <th>\n                <DropdownButton\n                  title="armor"\n                  variant="primary"\n                  id="armor"\n                  key="armor"\n                >\n                  {gear[1] === "no armor" && (\n                    <Dropdown.Item eventKey="1"> {gear[1]}</Dropdown.Item>\n                  )}\n                  {gear[1] && gear[1] !== "no armor" && (\n                    <Dropdown.Item eventKey="1">{gear[1].name} </Dropdown.Item>\n                  )}\n                  {gear[1] && gear[1] !== "no armor" && (\n                    <Dropdown.Item eventKey="1">\n                      Attack: {gear[1].attack}{" "}\n                    </Dropdown.Item>\n                  )}\n                  {gear[1] && gear[1] !== "no armor" && (\n                    <Dropdown.Item eventKey="1">\n                      Defence: {gear[1].defence}{" "}\n                    </Dropdown.Item>\n                  )}\n                </DropdownButton>\n              </th>\n\n              <th>\n                <DropdownButton\n                  title="skill"\n                  variant="success"\n                  id="skill"\n                  key="skill"\n                >\n                  {gear[2] === "no skill" && (\n                    <Dropdown.Item eventKey="2"> {gear[2]}</Dropdown.Item>\n                  )}\n                  {gear[2] && gear[2] !== "no skill" && (\n                    <Dropdown.Item eventKey="1">{gear[2].name} </Dropdown.Item>\n                  )}\n                  {gear[2] && gear[2] !== "no skill" && (\n                    <Dropdown.Item eventKey="1">\n                      Attack: {gear[2].attack}{" "}\n                    </Dropdown.Item>\n                  )}\n                  {gear[2] && gear[2] !== "no skill" && (\n                    <Dropdown.Item eventKey="1">\n                      Cost: {gear[2].cost}{" "}\n                    </Dropdown.Item>\n                  )}\n                </DropdownButton>\n              </th>\n            </tr>\n          </tbody>\n        </Table>\n      </React.Fragment>\n    );\n  }\n}\n\nexport { Display };\n')),(0,o.kt)("p",null,"In ",(0,o.kt)("inlineCode",{parentName:"p"},"HomePage"),", we passed ",(0,o.kt)("inlineCode",{parentName:"p"},"data")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"gear")," to ",(0,o.kt)("inlineCode",{parentName:"p"},"Display")," like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},'<Display className="basic" data={data} gear={gear} />\n')),(0,o.kt)("p",null,"Then, in ",(0,o.kt)("inlineCode",{parentName:"p"},"Display"),", we receive them by using ",(0,o.kt)("inlineCode",{parentName:"p"},"props")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},"const { data, gear } = this.props;\n")),(0,o.kt)("p",null,"Here I use a library called ",(0,o.kt)("inlineCode",{parentName:"p"},"react-bootstrap")," to decorate this component. Feel free to use anything you like. That is an advantage of React. You can use almost any library you want with React."),(0,o.kt)("h3",{id:"services"},"Services"),(0,o.kt)("p",null,"Create ",(0,o.kt)("inlineCode",{parentName:"p"},"services")," folder in ",(0,o.kt)("inlineCode",{parentName:"p"},"src"),". Here is where all API calls happen."),(0,o.kt)("h4",{id:"authenticationservice"},(0,o.kt)("inlineCode",{parentName:"h4"},"authenticationService")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"authenticationService")," is for all authentication API calls."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},'import { apiService } from "./APIServices";\nexport const authenticationService = {\n  login,\n  signup,\n  logout\n};\n\nconst axios = require("axios");\n\nfunction login(email, password, self) {\n  const data = {\n    email: email,\n    password: password\n  };\n  const header = {\n    "Content-Type": "application/json"\n  };\n  return axios\n    .post(apiService.login, data, header)\n    .then(function(response) {\n      localStorage.setItem("currentUser", response.data.token);\n      self.props.history.push("/");\n    })\n    .catch(function(error) {\n      if (!self.unmount) self.setState({ error });\n    });\n}\n\nfunction signup(email, password, self) {\n  const header = {\n    "Content-Type": "application/json"\n  };\n  const data = {\n    email: email,\n    password: password,\n    name: "nousername"\n  };\n  return axios\n    .post(apiService.character, data, header)\n    .then(function() {\n      self.props.history.push("/login");\n    })\n    .catch(function(error) {\n      if (!self.unmount) self.setState({ error });\n    });\n}\n\nfunction logout() {\n  console.log("logout");\n  localStorage.removeItem("currentUser");\n}\n')),(0,o.kt)("p",null,"We are using a library called ",(0,o.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/axios"},"axios")," to do all API calls. The basic syntax is like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"axios.get/post/put/patch(<Your_URL>,<Your_body>,<your_header>)\n")),(0,o.kt)("p",null,"In the login function:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},'axios\n  .post(apiService.login, data, header)\n  .then(function(response) {\n    localStorage.setItem("currentUser", response.data.token);\n    self.props.history.push("/");\n  })\n  .catch(function(error) {\n    if (!self.unmount) self.setState({ error });\n  });\n')),(0,o.kt)("p",null,"We store the token in ",(0,o.kt)("inlineCode",{parentName:"p"},"localStorage"),". Then we jump to the ",(0,o.kt)("inlineCode",{parentName:"p"},"HomePage"),". ",(0,o.kt)("inlineCode",{parentName:"p"},'self.props.history.push("/")')," is how we navigate between different components by using ",(0,o.kt)("inlineCode",{parentName:"p"},"react-router-dom"),"."),(0,o.kt)("h4",{id:"userservice"},(0,o.kt)("inlineCode",{parentName:"h4"},"userService")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"userService")," handles all API calls that related to users, like change name and fetch user data."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},'import { authenticationService } from "./AuthServices";\nimport { apiService } from "./APIServices";\n\nexport const userService = {\n  getUserData,\n  getGearData,\n  changeCharacterName,\n  initCharacter,\n  changeWeapon,\n  changeArmor,\n  changeSkill\n};\n\nconst axios = require("axios");\n\nfunction getUserData(currentUser, self) {\n  axios\n    .get(apiService.character, {\n      headers: { Authorization: `Bearer ${currentUser}` }\n    })\n    .then(function(response) {\n      self.setState({ data: response.data });\n    })\n    .catch(function() {\n      authenticationService.logout();\n    });\n}\n\nfunction getGearData(currentUser, self) {\n  axios\n    .get(apiService.updatecharacter, {\n      headers: { Authorization: `Bearer ${currentUser}` }\n    })\n    .then(function(response) {\n      self.setState({ gear: response.data });\n    })\n    .catch(function() {\n      authenticationService.logout();\n    });\n}\n\nfunction changeCharacterName(currentUser, name, self) {\n  const data = {\n    name: name\n  };\n  axios\n    .patch(apiService.changename, data, {\n      headers: { Authorization: `Bearer ${currentUser}` }\n    })\n    .catch(function(error) {\n      if (error.response && error.response.data.error.statusCode === 401)\n        authenticationService.logout();\n      else if (!self.unmount) self.setState({ error });\n    });\n}\n\nfunction initCharacter(currentUser, name, gear, self) {\n  const data = {\n    name: name,\n    gear\n  };\n  return axios\n    .patch(apiService.initCharacter, data, {\n      headers: { Authorization: `Bearer ${currentUser}` }\n    })\n    .catch(function(error) {\n      if (error.response && error.response.data.error.statusCode === 401)\n        authenticationService.logout();\n      else if (!self.unmount) self.setState({ error });\n    });\n}\n\nfunction changeWeapon(currentUser, gear, self) {\n  axios\n    .patch(apiService.updateweapon, gear.weapon, {\n      headers: { Authorization: `Bearer ${currentUser}` }\n    })\n    .catch(function(error) {\n      if (error.response && error.response.data.error.statusCode === 401)\n        authenticationService.logout();\n      else if (!self.unmount) self.setState({ error });\n    });\n}\n\nfunction changeArmor(currentUser, gear, self) {\n  axios\n    .patch(apiService.updatearmor, gear.armor, {\n      headers: { Authorization: `Bearer ${currentUser}` }\n    })\n    .catch(function(error) {\n      if (error.response && error.response.data.error.statusCode === 401)\n        authenticationService.logout();\n      else if (!self.unmount) self.setState({ error });\n    });\n}\n\nfunction changeSkill(currentUser, gear, self) {\n  axios\n    .patch(apiService.updateskill, gear.skill, {\n      headers: { Authorization: `Bearer ${currentUser}` }\n    })\n    .catch(function(error) {\n      if (error.response && error.response.data.error.statusCode === 401)\n        authenticationService.logout();\n      else if (!self.unmount) self.setState({ error });\n    });\n}\n')),(0,o.kt)("p",null,"You can check ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/gobackhuoxing/first-web-game-lb4/tree/part6/firstgame-frontend/src/services"},"here")," for the code of ",(0,o.kt)("inlineCode",{parentName:"p"},"Services"),"."),(0,o.kt)("h3",{id:"applying-this-to-your-own-project"},"Applying This to Your Own Project"),(0,o.kt)("p",null,"In this episode, we covered how to create simple login, signup and home pages with React. We also learned how to connect front-end and back-end. React is the most popular front-end framework today. You can easily use it to create your own front-end UI. It doesn't have to be React and LoopBack. The basic idea is similar."),(0,o.kt)("h3",{id:"whats-next"},"What's Next?"),(0,o.kt)("p",null,"Next time, we will extend our project on back-end APIs. So we can actually have something to play as a game."),(0,o.kt)("p",null,"In the meantime, learn more about LoopBack in ",(0,o.kt)("a",{parentName:"p",href:"https://strongloop.com/strongblog/tag_LoopBack.html"},"past blogs"),"."))}h.isMDXComponent=!0},276:function(e,n,t){n.Z=t.p+"assets/images/building-online-game-pt6-directory-structure-4e14406028ac402ba46bd7a71dec522e.jpg"},8528:function(e,n,t){n.Z=t.p+"assets/images/building-online-game-pt6-display-e3f8100212370b9cc761f964e3bd58fb.jpg"},8458:function(e,n,t){n.Z=t.p+"assets/images/building-online-game-pt6-init-c81bdd201c0c27375715cb272d421f3c.jpg"},5352:function(e,n,t){n.Z=t.p+"assets/images/building-online-game-pt6-login-d6e8e87ddb3dd9e6b5d1d3affa2eff37.jpg"},6472:function(e,n,t){n.Z=t.p+"assets/images/building-online-game-pt6-react-default-a55ee6e982dfa28d12e7f101e8f5c7a7.jpg"},2128:function(e,n,t){n.Z=t.p+"assets/images/building-online-game-pt6-structure-bb6a0cdee86daf8af434ae4c2dc8ac0a.jpg"}}]);